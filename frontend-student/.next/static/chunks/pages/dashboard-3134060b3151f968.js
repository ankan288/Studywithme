(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{528:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(3976)}])},3976:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return I}});var l,a,i=t(5893),n=t(7294),r=t(1664),d=t.n(r),c=t(9008),o=t.n(c),x=t(8979),h=t(9871),m=t(8361),u=t(2089);let p=t(3454).env.NEXT_PUBLIC_API_URL||"http://localhost:3000",j=async()=>{try{let e=await fetch("".concat(p,"/api/dashboard/metrics"));return await e.json()}catch(e){return console.error("[Dashboard API Error]",e),{success:!1,error:"Failed to fetch dashboard metrics"}}};var b=t(9176),g=t(437),f=t(1592);let N=e=>{let{metrics:s}=e;return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,i.jsx)(v,{icon:b.Z,label:"Total Students",value:s.totalStudents,color:"bg-blue-50 text-blue-600"}),(0,i.jsx)(v,{icon:g.Z,label:"Avg. Mastery",value:"".concat(s.avgMastery,"%"),color:"bg-emerald-50 text-emerald-600"}),(0,i.jsx)(v,{icon:u.Z,label:"Active (7d)",value:s.activeStudentsLast7Days,color:"bg-indigo-50 text-indigo-600"}),(0,i.jsx)(v,{icon:f.Z,label:"At-Risk Topics",value:s.topicsAtRisk.length,color:"bg-red-50 text-red-600"})]}),(0,i.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Topic Performance Watchlist"}),0===s.topicsAtRisk.length?(0,i.jsxs)("div",{className:"text-center py-8 text-slate-400",children:[(0,i.jsx)(y,{}),(0,i.jsx)("p",{className:"mt-2",children:"All topics are performing well."})]}):(0,i.jsx)("div",{className:"space-y-4",children:s.topicsAtRisk.map((e,s)=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-100",children:[(0,i.jsx)("span",{className:"font-medium text-red-800",children:e.topic}),(0,i.jsxs)("span",{className:"font-bold text-red-600",children:[e.avgScore.toFixed(0),"%"]})]},s))})]})]})},v=e=>{let{icon:s,label:t,value:l,color:a}=e;return(0,i.jsxs)("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center gap-4",children:[(0,i.jsx)("div",{className:"p-3 rounded-lg ".concat(a),children:(0,i.jsx)(s,{size:24})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm text-slate-500",children:t}),(0,i.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:l})]})]})},y=()=>(0,i.jsx)("svg",{className:"w-12 h-12 mx-auto text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});(l=a||(a={})).Core="Core",l.Applied="Applied",l.Mastery="Mastery";let w=e=>{let{distribution:s,total:t}=e,l=e=>t>0?e/t*100:0;return(0,i.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-6",children:"Learning Depth Distribution"}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(k,{label:"Core (Fundamentals)",percent:l(s.Core),count:s.Core,color:"bg-blue-500"}),(0,i.jsx)(k,{label:"Applied (Practice)",percent:l(s.Applied),count:s.Applied,color:"bg-emerald-500"}),(0,i.jsx)(k,{label:"Mastery (Deep Dive)",percent:l(s.Mastery),count:s.Mastery,color:"bg-purple-500"})]}),(0,i.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-100",children:(0,i.jsx)("p",{className:"text-xs text-slate-400",children:"* Shows the proportion of interactions at each depth level across all sessions."})})]})},k=e=>{let{label:s,percent:t,count:l,color:a}=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,i.jsx)("span",{className:"text-sm font-medium text-slate-700",children:s}),(0,i.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:[l," (",t.toFixed(1),"%)"]})]}),(0,i.jsx)("div",{className:"w-full bg-slate-100 rounded-full h-2.5",children:(0,i.jsx)("div",{className:"h-2.5 rounded-full transition-all duration-500 ".concat(a),style:{width:"".concat(t,"%")}})})]})};var C=t(2278),A=t(9200);let D=e=>{let{flagCount:s,totalInteractions:t}=e,l=t>0?(t-s)/t*100:100;return(0,i.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-full flex flex-col",children:[(0,i.jsxs)("h3",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[(0,i.jsx)(C.Z,{className:"text-indigo-600"})," Ethics & Compliance"]}),(0,i.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-center text-center",children:[(0,i.jsxs)("div",{className:"relative w-32 h-32 mb-4",children:[(0,i.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 36 36",children:[(0,i.jsx)("path",{className:"text-slate-100",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"4"}),(0,i.jsx)("path",{className:"text-indigo-600 transition-all duration-1000",strokeDasharray:"".concat(l,", 100"),d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"currentColor",strokeWidth:"4"})]}),(0,i.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:[(0,i.jsxs)("span",{className:"text-3xl font-bold text-slate-800",children:[l.toFixed(1),"%"]}),(0,i.jsx)("span",{className:"text-[10px] text-slate-400 uppercase",children:"Compliance"})]})]}),(0,i.jsxs)("div",{className:"w-full flex justify-between px-4 py-2 bg-slate-50 rounded-lg",children:[(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("span",{className:"block text-xs text-slate-500",children:"Interventions"}),(0,i.jsx)("span",{className:"block text-lg font-bold text-amber-500",children:s})]}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("span",{className:"block text-xs text-slate-500",children:"Total Queries"}),(0,i.jsx)("span",{className:"block text-lg font-bold text-slate-700",children:t})]})]}),s>0&&(0,i.jsxs)("div",{className:"mt-4 flex items-start gap-2 text-left p-3 bg-amber-50 rounded-lg border border-amber-100 text-xs text-amber-800",children:[(0,i.jsx)(A.Z,{size:14,className:"mt-0.5 shrink-0"}),(0,i.jsxs)("p",{children:[s," attempts to solicit direct answers were detected and neutralized by the Ethics Guard."]})]})]})]})};var M=t(2217),_=t(6611);let S=e=>{let{avgAlignment:s,avgClarity:t}=e;return(0,i.jsxs)("div",{className:"bg-slate-900 text-white p-6 rounded-xl shadow-lg relative overflow-hidden",children:[(0,i.jsx)("div",{className:"absolute top-0 right-0 p-3 opacity-10",children:(0,i.jsx)(M.Z,{size:120})}),(0,i.jsxs)("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:[(0,i.jsx)(_.Z,{className:"text-yellow-400"})," System Health"]}),(0,i.jsxs)("div",{className:"space-y-6 relative z-10",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,i.jsx)("span",{className:"text-sm text-slate-300",children:"Depth Alignment Score"}),(0,i.jsxs)("span",{className:"font-bold text-emerald-400",children:[(100*s).toFixed(0),"%"]})]}),(0,i.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,i.jsx)("div",{className:"bg-emerald-500 h-2 rounded-full",style:{width:"".concat(100*s,"%")}})})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,i.jsx)("span",{className:"text-sm text-slate-300",children:"Response Clarity Index"}),(0,i.jsxs)("span",{className:"font-bold text-blue-400",children:[(100*t).toFixed(0),"%"]})]}),(0,i.jsx)("div",{className:"w-full bg-slate-700 rounded-full h-2",children:(0,i.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(100*t,"%")}})})]})]}),(0,i.jsx)("div",{className:"mt-6 text-xs text-slate-500",children:"Metrics computed real-time via internal rule-based evaluation."})]})};function I(){let[e,s]=(0,n.useState)(null),[t,l]=(0,n.useState)(!0),[a,r]=(0,n.useState)("teacher"),c=async()=>{l(!0);let e=await j();e.success&&e.data&&s(e.data),l(!1)};return(0,n.useEffect)(()=>{c()},[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o(),{children:(0,i.jsx)("title",{children:"Dashboard - StudyWithMe"})}),(0,i.jsxs)("div",{className:"min-h-screen bg-slate-100 flex flex-col font-sans text-slate-900",children:[(0,i.jsxs)("header",{className:"bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shadow-sm sticky top-0 z-10",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"bg-indigo-600 text-white p-2 rounded-lg",children:(0,i.jsx)(x.Z,{size:20})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"font-bold text-lg leading-tight text-slate-800",children:"StudyWithMe Dashboard"}),(0,i.jsx)("p",{className:"text-[10px] text-slate-500 uppercase tracking-wider font-semibold",children:"teacher"===a?"Teacher View":"Institution Audit"})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsxs)("div",{className:"bg-slate-100 p-1 rounded-lg flex text-sm font-medium",children:[(0,i.jsx)("button",{onClick:()=>r("teacher"),className:"px-4 py-1.5 rounded-md transition-all ".concat("teacher"===a?"bg-white shadow-sm text-indigo-700":"text-slate-500 hover:text-slate-700"),children:"Teacher"}),(0,i.jsx)("button",{onClick:()=>r("institution"),className:"px-4 py-1.5 rounded-md transition-all ".concat("institution"===a?"bg-white shadow-sm text-indigo-700":"text-slate-500 hover:text-slate-700"),children:"Institution"})]}),(0,i.jsx)("button",{onClick:c,className:"p-2 hover:bg-slate-50 rounded-full text-slate-400 hover:text-indigo-600 transition-colors",children:(0,i.jsx)(h.Z,{size:18,className:t?"animate-spin":""})}),(0,i.jsx)("div",{className:"h-6 w-px bg-slate-200"}),(0,i.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,i.jsxs)(d(),{href:"/",className:"flex items-center gap-2 text-sm font-medium text-slate-500 hover:text-slate-800 px-3 py-1.5 rounded-lg hover:bg-slate-50",children:[(0,i.jsx)(m.Z,{size:16}),"Home"]}),(0,i.jsxs)(d(),{href:"/learn",className:"flex items-center gap-2 text-sm font-medium text-slate-500 hover:text-slate-800 px-3 py-1.5 rounded-lg hover:bg-slate-50",children:[(0,i.jsx)(u.Z,{size:16}),"Learn"]})]})]})]}),(0,i.jsx)("main",{className:"flex-1 p-8 overflow-y-auto",children:t||!e?(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsxs)("div",{className:"animate-pulse flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-slate-200 rounded-full mb-4"}),(0,i.jsx)("div",{className:"h-4 w-32 bg-slate-200 rounded"})]})}):(0,i.jsxs)("div",{className:"max-w-6xl mx-auto space-y-8 animate-in fade-in duration-500",children:["teacher"===a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:"Class Progress Overview"}),(0,i.jsx)(N,{metrics:e.teacher})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsx)(w,{distribution:e.institution.depthDistribution,total:e.institution.totalInteractions}),(0,i.jsxs)("div",{className:"bg-indigo-50 border border-indigo-100 rounded-xl p-6 flex flex-col justify-center",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-indigo-900 mb-2",children:"Instructor Insight"}),(0,i.jsxs)("p",{className:"text-indigo-700 mb-4",children:["Based on recent activity, ",(0,i.jsx)("strong",{children:"Core"})," concepts are well understood. Consider assigning more ",(0,i.jsx)("strong",{children:"Applied"})," tasks to bridge the gap to Mastery."]}),(0,i.jsx)("button",{className:"self-start bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-indigo-700",children:"Generate Applied Assignment"})]})]})]}),"institution"===a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("section",{children:[(0,i.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:"System Audit"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,i.jsx)(S,{avgAlignment:e.institution.avgDepthAlignment,avgClarity:e.institution.avgClarity}),(0,i.jsx)(D,{flagCount:e.institution.ethicsFlagCount,totalInteractions:e.institution.totalInteractions}),(0,i.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Depth Compliance"}),(0,i.jsx)("p",{className:"text-sm text-slate-500 mb-4",children:"Ensure system is not defaulting to surface-level answers."}),(0,i.jsx)(w,{distribution:e.institution.depthDistribution,total:e.institution.totalInteractions})]})]})]}),(0,i.jsxs)("section",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[(0,i.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:"Transparency Log"}),(0,i.jsx)("p",{className:"text-sm text-slate-500 mb-6",children:"Recent system interventions and policy triggers."}),(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,i.jsx)("thead",{className:"bg-slate-50 text-slate-500 uppercase font-bold text-xs",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-4 py-3 rounded-l-lg",children:"Time"}),(0,i.jsx)("th",{className:"px-4 py-3",children:"Mode"}),(0,i.jsx)("th",{className:"px-4 py-3",children:"Depth"}),(0,i.jsx)("th",{className:"px-4 py-3",children:"Ethics Flag"}),(0,i.jsx)("th",{className:"px-4 py-3 rounded-r-lg",children:"Quality Score"})]})}),(0,i.jsx)("tbody",{className:"divide-y divide-slate-100",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,i.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,i.jsx)("td",{className:"px-4 py-3 text-slate-500",children:"Just now"}),(0,i.jsx)("td",{className:"px-4 py-3 font-medium",children:"Learning"}),(0,i.jsx)("td",{className:"px-4 py-3",children:(0,i.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-bold",children:"Core"})}),(0,i.jsx)("td",{className:"px-4 py-3 text-emerald-600",children:"Pass"}),(0,i.jsx)("td",{className:"px-4 py-3 font-bold text-slate-800",children:"0.98"})]},s))})]})})]})]})]})})]})]})}}},function(e){e.O(0,[78,888,774,179],function(){return e(e.s=528)}),_N_E=e.O()}]);